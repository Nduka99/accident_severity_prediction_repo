services:
  # 1. Backend Service (Public Web Service - Free Tier)
  # Changed from 'pserv' to 'web' because Private Services require a paid plan.
  # Security is handled via CORS and TrustedHost middleware in the code.
  - type: web
    name: accident-backend
    env: docker
    plan: free
    dockerContext: .
    dockerfilePath: Dockerfile
    envVars:
      - key: PYTHONUNBUFFERED
        value: 1
      - key: PORT
        value: 8000

  # 2. Frontend Service (Public - Web Access)
  # This is the only entry point for users.
  - type: web
    name: accident-frontend
    env: docker
    plan: free
    dockerContext: .
    dockerfilePath: frontend/Dockerfile
    envVars:
      - key: PYTHONUNBUFFERED
        value: 1
      - key: BACKEND_URL
        fromService:
          type: web
          name: accident-backend
          property: url
